# load packages
library(Seurat)

# dir.create
dir.create("Spatial-seq/results/SCT.CCA/1.data input & merge", recursive = T)

# Load10X_Spatial (for expr matrix) Function
Load10X_Spatial_ver2<-function (data.dir, filename = "filtered_feature_bc_matrix", 
                                assay = "Spatial", slice = "slice1", filter.matrix = TRUE, 
                                to.upper = FALSE, image = NULL, ...) 
{
  if (length(x = data.dir) > 1) {
    warning("'Load10X_Spatial' accepts only one 'data.dir'", 
            immediate. = TRUE)
    data.dir <- data.dir[1]
  }
  data <- Read10X(data.dir = file.path(data.dir, filename), 
                  ...)
  if (to.upper) {
    rownames(x = data) <- toupper(x = rownames(x = data))
  }
  object <- CreateSeuratObject(counts = data, assay = assay)
  if (is.null(x = image)) {
    image <- Read10X_Image(image.dir = file.path(data.dir, 
                                                 "spatial"), filter.matrix = filter.matrix)
  }
  else {
    if (!inherits(x = image, what = "VisiumV1")) 
      stop("Image must be an object of class 'VisiumV1'.")
  }
  image <- image[Cells(x = object)]
  DefaultAssay(object = image) <- assay
  object[[slice]] <- image
  return(object)
}
  
# Spatial-seq data input 
spe.2os3<-Load10X_Spatial_ver2(data.dir = "Spatial-seq/Matrix/2OS3",filename = "filtered_feature_bc_matrix/")
spe.3os3<-Load10X_Spatial_ver2(data.dir = "Spatial-seq/Matrix/data/3OS3/",filename = "filtered_feature_bc_matrix/")
spe.3od3<-Load10X_Spatial_ver2(data.dir = "Spatial-seq/Matrix/3OD3/",filename = "filtered_feature_bc_matrix/")

# change orig.ident
spe.2os3<-RenameIdents(spe.2os3,"SeuratProject"="2OS3")
spe.3os3<-RenameIdents(spe.3os3,"SeuratProject"="3OS3")
spe.3od3<-RenameIdents(spe.3od3,"SeuratProject"="3OD3")
spe.2os3$orig.ident<-Idents(spe.2os3)
spe.3os3$orig.ident<-Idents(spe.3os3)
spe.3od3$orig.ident<-Idents(spe.3od3)

# 3od3 sample delete optic chiasm region
spe.3od3 <- subset(spe.3od3,cells=c("AAACAGTGTTCCTGGG-1",
                                    "AAACATTTCCCGGATT-1",
                                    "AAACCTAAGCAGCCGG-1",
                                    "AAACGGGCGTACGGGT-1",
                                    "AAACGGTTGCGAACTG-1",
                                    "AAACTCGGTTCGCAAT-1",
                                    "AAAGAATGTGGACTAA-1",
                                    "AAAGGCTACGGACCAT-1",
                                    "AAATCCGATACACGCC-1",
                                    "AAATTGATAGTCCTTT-1",
                                    "AACAATACATTGTCGA-1",
                                    "AACAGCTGTGTGGCAA-1",
                                    "AACATTGTGACTCGAG-1",
                                    "AACCCGACAACCCGTG-1",
                                    "AACCTCGCTTTAGCCC-1",
                                    "AACGCGACCTTGGGCG-1",
                                    "AACTCCAGAGCGTGTT-1",
                                    "AAGACCCAACTGAACA-1",
                                    "AAGATGGCACCGGACC-1",
                                    "AAGCACCCTGCGTATC-1",
                                    "AAGCGCAGGGCTTTGA-1",
                                    "AAGCGTCCCTCATCGA-1",
                                    "AAGGGACTATGCATTC-1",
                                    "AAGTGAGTCGGGTTTA-1",
                                    "AAGTGCTTCTCTATTG-1",
                                    "AAGTTGTGATGTTATA-1",
                                    "AAGTTTATGGGCCCAA-1",
                                    "AATACCGGAGGGCTGT-1",
                                    "AATACCTGATGTGAAC-1",
                                    "AATAGTCCGTCCCGAC-1",
                                    "AATCAGGTTTCATTTA-1",
                                    "AATCGGTATAGCCCTC-1",
                                    "AATCGTGAGCCGAGCA-1",
                                    "AATGTGCCCGAGGTGT-1",
                                    "AATGTGCTAATCTGAG-1",
                                    "AATGTTGTCGTGAGAC-1",
                                    "AATTAACGGATTTCCA-1",
                                    "AATTATACCCAGCAAG-1",
                                    "AATTCCAAGCATGTAC-1",
                                    "AATTCGATTCGAGGAT-1",
                                    "AATTGCAGCAATCGAC-1",
                                    "ACAAAGCATGACCTAG-1",
                                    "ACAAGGATGCTTTAGG-1",
                                    "ACAATGAATACGGAGA-1",
                                    "ACAGCGACATTCTCAT-1",
                                    "ACAGGCACGGATCCTT-1",
                                    "ACATTTGAAACCTAAC-1",
                                    "ACCAACCGCACTCCAC-1",
                                    "ACCAAGTCATCGGCAG-1",
                                    "ACCCATTTGTCCCTCT-1",
                                    "ACCCGAGCGAAATTAC-1",
                                    "ACCCGATTGGTTCCGA-1",
                                    "ACCCGGAAACTCCCAG-1",
                                    "ACCCGTGTCATCAGTA-1",
                                    "ACCCTATGCCATATCG-1",
                                    "ACCCTCCCGTCAGGGC-1",
                                    "ACCGACACATCTCCCA-1",
                                    "ACCGAGTCTCCTTATT-1",
                                    "ACCGCTAGTCATTGGT-1",
                                    "ACCGTGACCACGTGGG-1",
                                    "ACCTACTATAAATCTA-1",
                                    "ACGACTCTAGGGCCGA-1",
                                    "ACGACTGGTCATACTC-1",
                                    "ACGCAAACTAATAGAT-1",
                                    "ACGCCAGTGCGTTTGC-1",
                                    "ACGGAACACGAGTGCC-1",
                                    "ACGGACTCTCAAAGCG-1",
                                    "ACGGTACAGTTCAATG-1",
                                    "ACGTACTTTGGCACGG-1",
                                    "ACGTAGGAGAGTCGCT-1",
                                    "ACGTTCACTATGCCGC-1",
                                    "ACGTTCGTTCAGGAAA-1",
                                    "ACGTTCTGTACAAGTC-1",
                                    "ACTACAAAGAGAGGTG-1",
                                    "ACTACGCGTTAGAATT-1",
                                    "ACTATTTCCGGGCCCA-1",
                                    "ACTCAAGTGCAAGGCT-1",
                                    "ACTCCAATATCATCAT-1",
                                    "ACTCCCTAATGCTAAA-1",
                                    "ACTCCGGCCGACCACT-1",
                                    "ACTCGCCGTTCGATAA-1",
                                    "ACTCTGACCTAATAGA-1",
                                    "ACTGCCCGCCATTCTC-1",
                                    "ACTTACGCATCCACGC-1",
                                    "ACTTCCATGCGGGACA-1",
                                    "AGAACTGTACTTTGTA-1",
                                    "AGAAGGTTGTAGGTCG-1",
                                    "AGAATACAGGCTATCC-1",
                                    "AGACTGTTACCGGGTC-1",
                                    "AGAGAAACACCAGAAA-1",
                                    "AGAGAAGGAGTACAAT-1",
                                    "AGATACCAATAGAACC-1",
                                    "AGATATAATACGACTA-1",
                                    "AGCAAAGGCCGCTAGT-1",
                                    "AGCAGAAGGAGAAAGA-1",
                                    "AGCAGCCAGATGAATA-1",
                                    "AGCAGTCGAAGCATGC-1",
                                    "AGCATTACGAGGCAAG-1",
                                    "AGCCAAGCTTTGTGTC-1",
                                    "AGCCACAGGTTACCCG-1",
                                    "AGCCATATAGTATGTG-1",
                                    "AGCCCGCAACAAGCAG-1",
                                    "AGCCCGGTAGCCTGTA-1",
                                    "AGCCCTCCCTGGTGGC-1",
                                    "AGCGATGCGCCTAATA-1",
                                    "AGCGCATAATGAATCG-1",
                                    "AGCGGACACTTCGTAG-1",
                                    "AGCGGGTCTGACACTC-1",
                                    "AGCTAACAAGCAATGT-1",
                                    "AGCTAAGTACGCAGGC-1",
                                    "AGCTTCTTCTCGAGCA-1",
                                    "AGGAAGCTGTCCGCCG-1",
                                    "AGGATATCCGACTGCA-1",
                                    "AGGCAGGGAGCGTACT-1",
                                    "AGGCCTATCATACCAA-1",
                                    "AGGCCTGAGAATCTCG-1",
                                    "AGGGTCAGAGCACTCG-1",
                                    "AGGGTGCCGTTCTTTA-1",
                                    "AGGGTTCAGACGGTCC-1",
                                    "AGGTAGATCGAGATAT-1",
                                    "AGGTGCACGTCCACAT-1",
                                    "AGGTGGTGACCTTCGC-1",
                                    "AGTAACTATAGCAGCC-1",
                                    "AGTAATCTAAGGGTGG-1",
                                    "AGTACAGAAGCTTATA-1",
                                    "AGTAGAAGGCGCCTCA-1",
                                    "AGTATACACAGCGACA-1",
                                    "AGTATGCTGGAGACCA-1",
                                    "AGTATTTGGCACGACC-1",
                                    "AGTCAAATGATGTGAT-1",
                                    "AGTCGTATAAAGCAGA-1",
                                    "AGTCTTTAAAGTGTCC-1",
                                    "AGTGACTGTGACACAA-1",
                                    "AGTGAGTCGAATTAAC-1",
                                    "AGTGATAACCTGCGCG-1",
                                    "AGTGCTAAACACAGCA-1",
                                    "AGTGGCCCGCAAATGG-1",
                                    "AGTGGCGTCTGAAGGT-1",
                                    "AGTTGACGGTCCTTGC-1",
                                    "AGTTGGCAAGGCTAGA-1",
                                    "AGTTTGCACCTGCCTC-1",
                                    "ATAATCTTGGAGAACC-1",
                                    "ATAATTAGCTAAGTAG-1",
                                    "ATACCTAACCAAGAAA-1",
                                    "ATACGTTATGCACGGA-1",
                                    "ATACTACCCGTACCAC-1",
                                    "ATACTGCCTTACACCG-1",
                                    "ATAGCAACTAGGGAAG-1",
                                    "ATATAAAGCGCTCGTG-1",
                                    "ATATAACACGGGCGCA-1",
                                    "ATATACGCTCGTGACG-1",
                                    "ATATCGTTCCTCGAAC-1",
                                    "ATATGGGATAGCAACT-1",
                                    "ATCATAGCCCTATGTA-1",
                                    "ATCCACATCGACAGAA-1",
                                    "ATCTACCATCTGCTCC-1",
                                    "ATCTAGCTTGTGAGGG-1",
                                    "ATCTCCCACGGAATAT-1",
                                    "ATCTGACATGGAAGGA-1",
                                    "ATCTGCTGTTATCGCC-1",
                                    "ATCTGGGCTGTTCTTG-1",
                                    "ATCTTATCGCACACCC-1",
                                    "ATGACTATCAGCTGTG-1",
                                    "ATGCTCTGGCGCGGTA-1",
                                    "ATGGGACCTGCTGAAC-1",
                                    "ATGTACGATGACGTCG-1",
                                    "ATGTAGCGCGCGTAGG-1",
                                    "ATGTCTTGTTTGACTC-1",
                                    "ATGTTGATTAGAGACT-1",
                                    "ATGTTGTAGTCTGTTT-1",
                                    "ATTATCGGAATGTACG-1",
                                    "ATTATTATGTCCGTCA-1",
                                    "ATTATTCAGAGTCACT-1",
                                    "ATTCATCGTTGAGGCA-1",
                                    "ATTCGCGCCTTGAGAG-1",
                                    "ATTGCCTTTATGTTTG-1",
                                    "ATTGGTTGTGCATTAC-1",
                                    "ATTGTCTGTTTCATGT-1",
                                    "ATTTCCGGGTTCTGCG-1",
                                    "CAAACCCTCCGGCGGG-1",
                                    "CAAAGATTATTGGGCC-1",
                                    "CAACCTACCGAGCAGT-1",
                                    "CAACGCGATGAGCCAA-1",
                                    "CAACTGCTCATCCGAT-1",
                                    "CAAGGCCAGTGGTGCA-1",
                                    "CAAGTAAGTGATAGAC-1",
                                    "CACAGGGCCGTTGTCA-1",
                                    "CACATCGTGCACGCGC-1",
                                    "CACATCTCACCGACGA-1",
                                    "CACCGGGCATCACAAG-1",
                                    "CACTCCTATGTAAGAT-1",
                                    "CACTCTCAAGCATCGA-1",
                                    "CACTCTTCTGCTAGCC-1",
                                    "CACTGACGATTGTGGA-1",
                                    "CAGATAATGGGCGGGT-1",
                                    "CAGCAGTCTGTGCTGC-1",
                                    "CAGCTCTGGGCTCACT-1",
                                    "CAGGCAGTCTTACCAG-1",
                                    "CAGGCGCACGGTGGTC-1",
                                    "CAGTTCGAGGACCCGA-1",
                                    "CATAAGAAGCTTGGCT-1",
                                    "CATACACGGTTCCCAC-1",
                                    "CATACGAACTAGCTGG-1",
                                    "CATACTTCTTTCTCCG-1",
                                    "CATAGAGGAGATACTA-1",
                                    "CATAGTCAAATACATA-1",
                                    "CATGAGATGCACTCTC-1",
                                    "CATGCGTTGAGAGGAG-1",
                                    "CATGGTTTATTAATCA-1",
                                    "CATTACGCAGGAAGGG-1",
                                    "CATTATCCCATTAACG-1",
                                    "CCAACCTTATGTAACT-1",
                                    "CCAAGGTTGCCCTTTC-1",
                                    "CCACGGCAGGTGTAGG-1",
                                    "CCACTCAGATCCGCAA-1",
                                    "CCAGCTCGAACGCATT-1",
                                    "CCAGTCTTGTCATAGA-1",
                                    "CCAGTTCGGTAACTCA-1",
                                    "CCATGTTCATCTATAT-1",
                                    "CCCAAGTCATTACACT-1",
                                    "CCCAATGAGATTTGCA-1",
                                    "CCCGGCACGTGTCAGG-1",
                                    "CCCGGGTCGTTCAGGG-1",
                                    "CCCGTAGCTGGGAAGA-1",
                                    "CCCTACCCACACCCAG-1",
                                    "CCCTACTTGAACAATG-1",
                                    "CCCTCGATAATACACA-1",
                                    "CCCTTTAATGGAGTTC-1",
                                    "CCGCACTTGCAATGAC-1",
                                    "CCGCTCCAGGGCGATC-1",
                                    "CCGCTCTTCCGAACTA-1",
                                    "CCGGAAGTGCAATATG-1",
                                    "CCGGAGCGTACTTTCT-1",
                                    "CCGGTTTGTAATTGTG-1",
                                    "CCGTAGGAAATCCCTG-1",
                                    "CCGTAGGGTTGTTTAC-1",
                                    "CCTATATTTGTCCTGG-1",
                                    "CCTATGGTCAAAGCTG-1",
                                    "CCTATGTCCACTCCAC-1",
                                    "CCTCCTGTTGTGTCGT-1",
                                    "CCTCGCGCTGTGCGAT-1",
                                    "CCTCGGTTTCCTTGCC-1",
                                    "CCTCTACAAGGATTGG-1",
                                    "CCTGAGAATAAATGCA-1",
                                    "CCTGATTCGCGAAGAA-1",
                                    "CCTGGTCGAATGTGGG-1",
                                    "CCTGTTCAACCTCGGG-1",
                                    "CCTGTTTGAAGACACG-1",
                                    "CCTTAAGTACGCAATT-1",
                                    "CCTTCAGTTAAAGTGA-1",
                                    "CCTTCGTATAGAATCC-1",
                                    "CCTTGTGAACGTGGTT-1",
                                    "CCTTTAAGGGAGCACT-1",
                                    "CGAATGACGCATAATG-1",
                                    "CGAGACTACTGCTGCT-1",
                                    "CGAGAGCTTTCACTAC-1",
                                    "CGAGGGTATCCAGGTG-1",
                                    "CGAGTGAAGGTACCAG-1",
                                    "CGATAGTCGTACTGCA-1",
                                    "CGATCCTCGCAACATA-1",
                                    "CGATTAAATATCTCCT-1",
                                    "CGATTCGCCTGGCTGC-1",
                                    "CGCACGTCTGTTTATG-1",
                                    "CGCATGCCGAATGCGT-1",
                                    "CGCCCAGCACGCCTAG-1",
                                    "CGCCCAGCGTTTCACG-1",
                                    "CGCCGCGTTCTGAACG-1",
                                    "CGCGAAGTGGCATACT-1",
                                    "CGCGACCGCGACAGAT-1",
                                    "CGCGGGAATTCCTTTC-1",
                                    "CGCTGTGTGGATGTTG-1",
                                    "CGCTTAGTATTGATAC-1",
                                    "CGCTTCGGTCTAAGAC-1",
                                    "CGCTTTCCGCCAAGGT-1",
                                    "CGGAAAGAATCAAACG-1",
                                    "CGGACCTTTACGTCCC-1",
                                    "CGGATCCTCAAGGACT-1",
                                    "CGGCCAGAGCGACCAT-1",
                                    "CGGCGCCATCAATCCC-1",
                                    "CGGGCGATGGATCACG-1",
                                    "CGGTCCGTCGCAAGCC-1",
                                    "CGGTTGAGTATCCTTC-1",
                                    "CGGTTGGGCAGGGTCC-1",
                                    "CGTAAAGCAAGAAATC-1",
                                    "CGTAACTTCGACACTT-1",
                                    "CGTAGAGAGTAATTAT-1",
                                    "CGTCGCATGTGAGCCA-1",
                                    "CGTGACCAGTCCTCTG-1",
                                    "CGTGCACACCACTGTA-1",
                                    "CGTGCTTCTACCTAAA-1",
                                    "CGTGGTACCCAAAGGC-1",
                                    "CGTGTATGGGAGCTGA-1",
                                    "CGTGTCTCGTTACGAC-1",
                                    "CGTTAATGTCCCGACG-1",
                                    "CGTTCAAGGAAACGGA-1",
                                    "CGTTCAGACCCGCGAA-1",
                                    "CGTTGAATACCGCGCT-1",
                                    "CGTTGCCCGCGTGGGA-1",
                                    "CGTTGTCGGCAATTGA-1",
                                    "CGTTTGTGTAGAGGGT-1",
                                    "CTAAATCCGGTGTACA-1",
                                    "CTACAAGAAATAACCC-1",
                                    "CTACTCAAGGTATAGT-1",
                                    "CTAGGGATAGGGACAA-1",
                                    "CTAGGTTCGGACGTGA-1",
                                    "CTAGTAGAAAGGGATT-1",
                                    "CTATAGGCGTTGATGT-1",
                                    "CTATATCCAGCCTGGC-1",
                                    "CTATCACAACGCTGGA-1",
                                    "CTATGAACACCTTGCC-1",
                                    "CTATGCCCGAATGCAA-1",
                                    "CTATTTGCTTGGAGGA-1",
                                    "CTCAAACCACTGCCCG-1",
                                    "CTCAACTAACCCGGAT-1",
                                    "CTCACATTTACTAAAT-1",
                                    "CTCACTGTGATACTTA-1",
                                    "CTCATAAATGTGTATA-1",
                                    "CTCATTGCTCTAACAA-1",
                                    "CTCCTCCAGCTCACAC-1",
                                    "CTCGAGGCAAGTTTCA-1",
                                    "CTCGCCGAATGTAGGG-1",
                                    "CTCGCTAGGTAAGCGA-1",
                                    "CTCGGGTTCTCTGGCC-1",
                                    "CTCGGTTGTCGGCCCT-1",
                                    "CTCGTCTGTGCCTTCG-1",
                                    "CTCGTTACGGCTACCA-1",
                                    "CTCTACATCCTGCGTG-1",
                                    "CTCTAGCCCTCGGAAA-1",
                                    "CTCTGTCCATGCACCA-1",
                                    "CTCTTCTGGAAGTTAG-1",
                                    "CTGATCCCTTTATGCA-1",
                                    "CTGCAGAGAATCAGAG-1",
                                    "CTGCCTTTAATACCTT-1",
                                    "CTGCCTTTCTAGTAAA-1",
                                    "CTGCGACCTCGCCGAA-1",
                                    "CTGCGATTTCGAGATT-1",
                                    "CTGGTAAAGACTTACA-1",
                                    "CTGTAGCCATCTCACT-1",
                                    "CTGTAGTGAGGATCGA-1",
                                    "CTTACATAGATTTCTT-1",
                                    "CTTAGTGTAGTAGCAT-1",
                                    "CTTAGTTGAGGAATCG-1",
                                    "CTTCAACTCCACTTGG-1",
                                    "CTTCAGTTGGACAACG-1",
                                    "CTTCCGCTCCGTGAAG-1",
                                    "CTTCGATTGCGCAAGC-1",
                                    "CTTCTGGGCGTACCTA-1",
                                    "CTTGATGACCATCCAG-1",
                                    "CTTGCCCACCCACGCA-1",
                                    "CTTGGCCAAGCTGGGA-1",
                                    "CTTTGCATCGCTCTTG-1",
                                    "CTTTGGGATTGTTGCA-1",
                                    "GAAACCTATACAAATG-1",
                                    "GAAAGCAGTGCACTTT-1",
                                    "GAACAACTGGGATGAA-1",
                                    "GAACAGATTACTAAAT-1",
                                    "GAACCCTCTGTGTTCT-1",
                                    "GAACCTTTAACGATCC-1",
                                    "GAACTGTGGAGAGACA-1",
                                    "GAAGAAACGATATTGT-1",
                                    "GAAGCCACTGATTATG-1",
                                    "GAAGCCTGCACATTCC-1",
                                    "GAAGGAGTCGAGTGCG-1",
                                    "GAAGGGTCATTAAGAC-1",
                                    "GAATAGTGCTCGATTA-1",
                                    "GAATGCGAATCGGTTC-1",
                                    "GACACAGCCGGGACTG-1",
                                    "GACACTTCCAATTACC-1",
                                    "GACATCCGTCGAACTG-1",
                                    "GACCACACTTCCCTTT-1",
                                    "GACCTTCCACGTCTAC-1",
                                    "GACGATATCACTGGGT-1",
                                    "GACGGGTTGGCCCGTA-1",
                                    "GACGTTGCTCGGCGGC-1",
                                    "GACTAGGCCGTTAGGT-1",
                                    "GACTGCAAATCGAGCT-1",
                                    "GACTGCTGGTGAGAAA-1",
                                    "GACTTCAACGCATCAA-1",
                                    "GAGAACGGTTCTGACT-1",
                                    "GAGAGTCTCGGGAGAG-1",
                                    "GAGATGGCTTTAATCA-1",
                                    "GAGCACCTGTGTCCAG-1",
                                    "GAGCATCAACAACTTG-1",
                                    "GAGCGGAATGCGGTGT-1",
                                    "GAGGAATATCTCTTTG-1",
                                    "GAGGCCTGTTGATACA-1",
                                    "GAGGGAGTCAGATCGC-1",
                                    "GAGGGTAGTAACAAAG-1",
                                    "GAGGTACGCGTGTCCC-1",
                                    "GAGTAGATACTAGTTG-1",
                                    "GAGTATACCCTAATCA-1",
                                    "GAGTATGCGCGTGCAT-1",
                                    "GAGTCAGACCAGAATC-1",
                                    "GAGTGTCAACCAGAAA-1",
                                    "GATAGAACCCGCTAGG-1",
                                    "GATAGATAGTACAGTC-1",
                                    "GATAGTGCGAGTAAGT-1",
                                    "GATCAACATAAAGGGA-1",
                                    "GATCTGCTATCTAAGG-1",
                                    "GATGACAAGTAGGGCA-1",
                                    "GATGAGGAACCTTCGG-1",
                                    "GATGCTACCTTCGATG-1",
                                    "GATTGCTCCAGTTGCA-1",
                                    "GATTGGGAAAGGTTGT-1",
                                    "GCAAACCTTGGCCATA-1",
                                    "GCAAGTGTAAAGCATG-1",
                                    "GCACACAGCTATTACC-1",
                                    "GCACAGCACGGGCCGA-1",
                                    "GCACCTAGGCGAGTCC-1",
                                    "GCACGCCGATTCCCGC-1",
                                    "GCACGCCTACTTAGAT-1",
                                    "GCACGTGGTTTACTTA-1",
                                    "GCACTGCCTACCTTTA-1",
                                    "GCAGCTGTCAACGCAT-1",
                                    "GCAGTGTGGCTATAGG-1",
                                    "GCATGCTAATAACGAT-1",
                                    "GCCACTCAGAGCGCGA-1",
                                    "GCCAGGAAAGAACACT-1",
                                    "GCCCTGAGGATGGGCT-1",
                                    "GCCGACCCACGACTGC-1",
                                    "GCCGGTCGTATCTCTC-1",
                                    "GCCGTCGGTTTCGGGC-1",
                                    "GCCTACGTTCTGTGCA-1",
                                    "GCCTCCGACAATTCAC-1",
                                    "GCGAAGAATCTGACGG-1",
                                    "GCGACCCAACCATCTG-1",
                                    "GCGCAAATATATTCAA-1",
                                    "GCGCGGTCTAGTAACT-1",
                                    "GCGGAGAAACTTCGCA-1",
                                    "GCGGCAAAGTATTGCC-1",
                                    "GCGGCTTTAGCAAGTT-1",
                                    "GCGGTCTTGCTTTCAC-1",
                                    "GCGTCCCTAAGACATA-1",
                                    "GCGTCGTAACATGGTC-1",
                                    "GCTAACTGAAGTCTGA-1",
                                    "GCTACAATCGAGGATA-1",
                                    "GCTCAATGTAATACCG-1",
                                    "GCTCCATGCAAAGCAA-1",
                                    "GCTCCTGACATACTGG-1",
                                    "GCTCTTTCCGCTAGTG-1",
                                    "GCTGCTAAGTAGTCGA-1",
                                    "GCTGGGAGCGCGTCAA-1",
                                    "GCTTCCATGTAACCGC-1",
                                    "GCTTCCCGTAAGCTCC-1",
                                    "GGAAACTAAATGGGCC-1",
                                    "GGAAAGGGAATTGAGC-1",
                                    "GGAACTTTGGCGATTA-1",
                                    "GGAAGGACACCGTATA-1",
                                    "GGACAACCATGAAGCC-1",
                                    "GGACCTCTAGGCCGCC-1",
                                    "GGACTCGACAGCGCAT-1",
                                    "GGACTCGTGAGTGGTC-1",
                                    "GGACTCTTTGACTAAG-1",
                                    "GGAGCGAGGCCTACTT-1",
                                    "GGATCTTACTGCCCTT-1",
                                    "GGATGGCTTGAAGTAT-1",
                                    "GGATTAATCATGGACC-1",
                                    "GGATTGCTGTGACTCC-1",
                                    "GGCAAGCCCATAGTGG-1",
                                    "GGCCAATTGTATAGAC-1",
                                    "GGCCCAGCTGGTTTGC-1",
                                    "GGCCGAGACTCTGGTG-1",
                                    "GGCCGGCGTCTGCTAT-1",
                                    "GGCCGTTTGGGTTTCA-1",
                                    "GGCCTGCTCTGATGTT-1",
                                    "GGCGCGGAGATCTTTC-1",
                                    "GGCGCTTCATTCCCTG-1",
                                    "GGCGTAGGGAAAGCTG-1",
                                    "GGCTACTATACACTCC-1",
                                    "GGCTCCTCCACCTGTT-1",
                                    "GGCTTTCAATAAGGGT-1",
                                    "GGGAAAGAATGCCAAC-1",
                                    "GGGAACGGTTTCAGAT-1",
                                    "GGGAAGACGGTCTGTC-1",
                                    "GGGAAGGGCTTTCTCA-1",
                                    "GGGACCCGTATATCTT-1",
                                    "GGGAGCGACCGTAGTG-1",
                                    "GGGCACGTAGTACTGT-1",
                                    "GGGCAGAGCAATCGTT-1",
                                    "GGGCAGTCAACGCCAA-1",
                                    "GGGCGTGGTTTCCCAG-1",
                                    "GGGCTATGATCGATGG-1",
                                    "GGGTCAGGAGCTAGAT-1",
                                    "GGTAACCGGGAGGATA-1",
                                    "GGTCGGTCGTCCACAG-1",
                                    "GGTCTCCGTCCAGGTT-1",
                                    "GGTCTTGAGCGCTCTT-1",
                                    "GGTGCATAAATGATTA-1",
                                    "GGTGTAAATCGATTGT-1",
                                    "GGTGTAGGTAAGTAAA-1",
                                    "GGTTCGCATTTGCCGT-1",
                                    "GGTTTAATTACCATCG-1",
                                    "GGTTTGTGACCTGAGG-1",
                                    "GTAACTGCCCAAGGAG-1",
                                    "GTACTACGGCCTCGTT-1",
                                    "GTAGACACGCCTGACT-1",
                                    "GTAGCTCCGGGAGGCT-1",
                                    "GTAGTCTACGATATTG-1",
                                    "GTAGTTCGAAGGCGAA-1",
                                    "GTATCAAGGTACTTCC-1",
                                    "GTATCCTTTGGTAACC-1",
                                    "GTCAACCAGGCCTATA-1",
                                    "GTCATGCGCGAGGGCT-1",
                                    "GTCCAATATTTAGCCT-1",
                                    "GTCCAGGCACGTGTGC-1",
                                    "GTCCCGCGACGTTATG-1",
                                    "GTCCGGGTTCACATTA-1",
                                    "GTCGCCGTTGTGTGTT-1",
                                    "GTCGGGAAGCAGAAAC-1",
                                    "GTCTAGTGAGCCGCTT-1",
                                    "GTCTATTGCATGCTCG-1",
                                    "GTCTCAAGGCCCGGCT-1",
                                    "GTCTCCGCCTCAATAC-1",
                                    "GTCTGCCGACTCGACG-1",
                                    "GTCTGTAGGTTGAACA-1",
                                    "GTGACAGCTTCCCACT-1",
                                    "GTGACGCAGGTTTCAT-1",
                                    "GTGAGATAACCTTATA-1",
                                    "GTGATCAAGCGTGCAC-1",
                                    "GTGATCCTTGTCATGA-1",
                                    "GTGCACCAGCTTCAAC-1",
                                    "GTGCCTGAGACCAAAC-1",
                                    "GTGGCTGTTTCTGTTC-1",
                                    "GTGGGAACAAACCGGG-1",
                                    "GTGGTATAGTCTGCCG-1",
                                    "GTGTATATCAGCGGGC-1",
                                    "GTGTCAGTGTACGTGG-1",
                                    "GTTAAGGGTGCGATGT-1",
                                    "GTTAGCCCATGACATC-1",
                                    "GTTATCAAGCTATCGA-1",
                                    "GTTCAGTCGCCAAATG-1",
                                    "GTTCCGTCCGCCTGCA-1",
                                    "GTTGTAGATTTATGAG-1",
                                    "GTTTCAAACGAGTTGT-1",
                                    "GTTTCTAGAGGCGCGG-1",
                                    "GTTTGGGTTTCGCCCG-1",
                                    "GTTTGGTGATCGGTGC-1",
                                    "TAAAGCGGTATTTCCA-1",
                                    "TAAAGTGCACGTCTCG-1",
                                    "TAAATTTAGTAACACC-1",
                                    "TAACAGCGTTTGTGCT-1",
                                    "TAACCTAGGGAGTCCA-1",
                                    "TAAGGCATAACATCAA-1",
                                    "TAAGGCCCGTCACCCT-1",
                                    "TAATACTAGAACAGAC-1",
                                    "TAATTACGTCAGTAGA-1",
                                    "TACAAGGGCTTCTTTA-1",
                                    "TACACAGCCGTGGTGC-1",
                                    "TACACCTCTTCGAATC-1",
                                    "TACAGAAACGGTGGGC-1",
                                    "TACCAAATAGCCCAGA-1",
                                    "TACCAGGAATCCCGTC-1",
                                    "TACCGAATAATTGTAA-1",
                                    "TACCGTAGGTTAACTA-1",
                                    "TACCTACTCCCAGTAT-1",
                                    "TACCTCAGTTGTCTGT-1",
                                    "TACCTCCACACCAATG-1",
                                    "TACGCCGAGGGTACCC-1",
                                    "TACGGAAGCCAAACCA-1",
                                    "TACGGGTAATAACATA-1",
                                    "TACGTAAAGCGGAGTG-1",
                                    "TACGTACTAGTGCTGA-1",
                                    "TACGTGGGCCCAGGGC-1",
                                    "TACTACGTGCAATGCG-1",
                                    "TACTATGGTTCCTCAG-1",
                                    "TACTCCTCTAGTTGAC-1",
                                    "TACTCGTTTGAATCAA-1",
                                    "TACTCTTTCGTCTTCA-1",
                                    "TACTGAACAGATTTAG-1",
                                    "TACTTAAACATGTACA-1",
                                    "TAGAATAGCCGATGAA-1",
                                    "TAGACGAAACGCCAAT-1",
                                    "TAGAGTGTTCCGGGTA-1",
                                    "TAGATGGTTCCTTACT-1",
                                    "TAGATTCAAAGTGCGG-1",
                                    "TAGCAGATACTTAGGG-1",
                                    "TAGCAGTATGACTAAA-1",
                                    "TAGCTAGTGATGATGG-1",
                                    "TAGGCCTATATAGTCT-1",
                                    "TAGGCTAAAGTGGCAC-1",
                                    "TAGGTGACGATAACCT-1",
                                    "TAGGTGTTCCACAGAT-1",
                                    "TAGGTTCTGCTGAGAA-1",
                                    "TAGTAGCTTATACCAG-1",
                                    "TAGTCCCGGAGACCAC-1",
                                    "TAGTCTGCGGCACATT-1",
                                    "TATACGCGTCATCACT-1",
                                    "TATAGAGTCGCTTGAA-1",
                                    "TATATAGGGCTTTACG-1",
                                    "TATATATCGAGAAATG-1",
                                    "TATATCAAAGTGATCT-1",
                                    "TATCCGCACCGTCGGG-1",
                                    "TATCCTATCAACTGGT-1",
                                    "TATGAAGAATTAAGGT-1",
                                    "TATGATCTTCTCTTTA-1",
                                    "TATGTAAAGTGCTTAA-1",
                                    "TATTAACCTGACCGCG-1",
                                    "TCAAATTGTTGTGCCG-1",
                                    "TCAAATTTGAGACTCA-1",
                                    "TCAACATAGCGCCCTA-1",
                                    "TCAATACGCCGTCATG-1",
                                    "TCAATCCGGGAAGTTT-1",
                                    "TCACAAACCGAGGTAC-1",
                                    "TCACTATCCCTTCGGT-1",
                                    "TCAGAGGACGCGTTAG-1",
                                    "TCAGCAGTAGGCCCTG-1",
                                    "TCAGCCAATCCGTAAA-1",
                                    "TCAGTGTATACGTCAT-1",
                                    "TCATATGAGCTTTGTT-1",
                                    "TCATCCTCAGCTGCTT-1",
                                    "TCATCGACGACCGTCG-1",
                                    "TCATCGATGGTCCCAA-1",
                                    "TCCAACTCAGCTATCT-1",
                                    "TCCAAGCCTAGACACA-1",
                                    "TCCAATAAAGGCTACC-1",
                                    "TCCACATCGTATATTG-1",
                                    "TCCACCAAGACATAGG-1",
                                    "TCCACCTCTAGCCTTT-1",
                                    "TCCAGGGTATATACGA-1",
                                    "TCCGACCGCTAATCAA-1",
                                    "TCCGGGCTTGACGGGA-1",
                                    "TCCTAAAGATTCAGAC-1",
                                    "TCCTAACCGTCGGGCA-1",
                                    "TCCTTGTCCTTTAATT-1",
                                    "TCGAATATCCCGCAGG-1",
                                    "TCGACATAGCGTAGCG-1",
                                    "TCGAGCCAGGCAGGCC-1",
                                    "TCGCATAAAGGGCGCA-1",
                                    "TCGCCGACATATTCGC-1",
                                    "TCGCCTCCTTCGGCTC-1",
                                    "TCGCTACTGGCTTTGA-1",
                                    "TCGCTGCCAATGCTGT-1",
                                    "TCGGCTTGTATCGACG-1",
                                    "TCGGGAGACAGCGTAC-1",
                                    "TCGTACCGACGTCAAG-1",
                                    "TCGTCAAGTACGCGCA-1",
                                    "TCGTTTACGCGACCCT-1",
                                    "TCTATAGGTGGGTAAT-1",
                                    "TCTATCCGATTGCACA-1",
                                    "TCTATGCTATAACGAC-1",
                                    "TCTCAAATCAATCGGG-1",
                                    "TCTCCACAAGTTGAAT-1",
                                    "TCTCTTACCGCGAACC-1",
                                    "TCTGCATACCTTGCTT-1",
                                    "TCTTGCTCCCGATACT-1",
                                    "TGAACAAGCAGGGACT-1",
                                    "TGAATACCGACGCGTA-1",
                                    "TGAATGAGTGTTTCCC-1",
                                    "TGACATGTAACGTGAC-1",
                                    "TGACCAAATCTTAAAC-1",
                                    "TGAGGAGTGCCAGCTT-1",
                                    "TGAGGTGTGTGGCGGA-1",
                                    "TGAGTGTAACAACGGG-1",
                                    "TGATACATTTAGCCGT-1",
                                    "TGATCACCACACTGAC-1",
                                    "TGATCTATCACACTCT-1",
                                    "TGATGTCAATTAAGTG-1",
                                    "TGATTCCCGGTTACCT-1",
                                    "TGCAAAGTTCGTCTGT-1",
                                    "TGCAACCCATCTGCGG-1",
                                    "TGCAACTACTGGTTGA-1",
                                    "TGCAATCTAACACGGT-1",
                                    "TGCATGTGACCCATAG-1",
                                    "TGCCGGATGTACGAGC-1",
                                    "TGCCGTGGATCGTCCT-1",
                                    "TGCCGTGGGACCCAAT-1",
                                    "TGCGACGGCCGAACGT-1",
                                    "TGCGGACTTGACTCCG-1",
                                    "TGCGTACGGCTAATTG-1",
                                    "TGCTCGGCGAAACCCA-1",
                                    "TGCTCGGTGGGTCACC-1",
                                    "TGCTCTTGAGAGTTTG-1",
                                    "TGCTTAGAGAGAATGC-1",
                                    "TGCTTCCCAAGCAGTA-1",
                                    "TGGACCAATCTAAGAT-1",
                                    "TGGAGAATAATCGTCC-1",
                                    "TGGCAAGCACAAGTCG-1",
                                    "TGGCTACACTCTACCT-1",
                                    "TGGCTATGTGACATAC-1",
                                    "TGGGCGATACAATAAG-1",
                                    "TGGGTGCACAAGCCAT-1",
                                    "TGGGTGTAATAGATTT-1",
                                    "TGGGTGTTAAGTAGAA-1",
                                    "TGGTCGATATACCTCT-1",
                                    "TGTACCTACACGAGGG-1",
                                    "TGTAGCCAATTCCGTT-1",
                                    "TGTCCACGGCTCAACT-1",
                                    "TGTGACTAGAGTTTGC-1",
                                    "TGTGAGACTAGCCCAA-1",
                                    "TGTGGCGGGCTTCTGG-1",
                                    "TGTGGTTGCTAAAGCT-1",
                                    "TGTTCCGGCCTGAGCT-1",
                                    "TTAAAGTAAGTCGCCA-1",
                                    "TTAAGTATTGTTATCC-1",
                                    "TTAATTGCTTTGGGTG-1",
                                    "TTACACGATCTGCGAC-1",
                                    "TTACCCTAGGGATTGG-1",
                                    "TTAGAATAAGGGTCGG-1",
                                    "TTAGGTCATAACCGAC-1",
                                    "TTAGTAAACCTGCTCT-1",
                                    "TTATAGGTAATTGTCT-1",
                                    "TTCACTTCCTAGAACG-1",
                                    "TTCAGTTCAAGAGGAG-1",
                                    "TTCCATCGACAGCGTG-1",
                                    "TTCGCACTGTACGACA-1",
                                    "TTCGCGCGCCATACGA-1",
                                    "TTCGGGCGCTAGTCTT-1",
                                    "TTCGGTACTGTAGAGG-1",
                                    "TTCTAGAAAGTCTTAT-1",
                                    "TTCTATTAAACGCAGC-1",
                                    "TTGAACGACGTGCTGA-1",
                                    "TTGACCAGGAACAACT-1",
                                    "TTGATGCCGCTCGTCG-1",
                                    "TTGCAAGAAGACTCCT-1",
                                    "TTGCCGCTTTCTAGTA-1",
                                    "TTGCCTTCTCGCCGGG-1",
                                    "TTGCGCTTGATCAATA-1",
                                    "TTGCGTGTGTAGGCAT-1",
                                    "TTGCTCATAGTACGTG-1",
                                    "TTGGCCAAATTGTATC-1",
                                    "TTGGGAAGACGAGCCG-1",
                                    "TTGTGCAGCCACGTCA-1",
                                    "TTGTGGTGGTACTAAG-1",
                                    "TTGTGTATGCCACCAA-1",
                                    "TTGTTTCACATCCAGG-1",
                                    "TTGTTTCATTAGTCTA-1",
                                    "TTGTTTGTATTACACG-1"),invert=T)
# merge data
seurat.list <- list(spe.2os3=spe.2os3,spe.3os3=spe.3os3,spe.3od3=spe.3od3)
## SCTransform 
seurat.list <- lapply(X = seurat.list, FUN = SCTransform, assay = "Spatial")
features <- SelectIntegrationFeatures(object.list = seurat.list, nfeatures = 2000)
## find anchor
seurat.list <- PrepSCTIntegration(object.list = seurat.list, anchor.features = features)
seurat.obj.anchors <- FindIntegrationAnchors(object.list = seurat.list, normalization.method = "SCT", anchor.features = features)
seurat.obj.combined <- IntegrateData(anchorset = seurat.obj.anchors, normalization.method = "SCT")

saveRDS(seurat.obj.combined,file = "Spatial-seq/results/SCT.CCA/1.data input & merge/goat_on spatial-seq sct_cca drop_chiasm.rds")


  
